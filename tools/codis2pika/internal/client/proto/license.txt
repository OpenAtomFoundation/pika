port from https://github.com/go-redis/redis/tree/master/internal/proto